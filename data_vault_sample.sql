
-- Create DEPT Table
CREATE TABLE dept (
  deptno NUMBER(2,0) PRIMARY KEY,
  dname  VARCHAR2(14),
  loc    VARCHAR2(13)
);

-- Create EMP Table
CREATE TABLE emp (
  empno    NUMBER(4,0) PRIMARY KEY,
  ename    VARCHAR2(10),
  job      VARCHAR2(9),
  mgr      NUMBER(4,0),
  hiredate DATE,
  deptno   NUMBER(2,0),
  FOREIGN KEY (deptno) REFERENCES dept(deptno)
);

-- Create SALARY Table
CREATE TABLE salary (
  empno    NUMBER(4,0),
  salary   NUMBER(7,2),
  bonus    NUMBER(7,2),
  PRIMARY KEY (empno),
  FOREIGN KEY (empno) REFERENCES emp(empno)
);

-- Insert data into DEPT Table
INSERT INTO dept VALUES (10, 'ACCOUNTING', 'NEW YORK');
INSERT INTO dept VALUES (20, 'RESEARCH', 'DALLAS');
INSERT INTO dept VALUES (30, 'SALES', 'CHICAGO');
INSERT INTO dept VALUES (40, 'OPERATIONS', 'BOSTON');

-- Insert data into EMP Table
INSERT INTO emp VALUES (7839, 'KING', 'PRESIDENT', NULL, TO_DATE('1981-11-17', 'YYYY-MM-DD'), 10);
INSERT INTO emp VALUES (7698, 'BLAKE', 'MANAGER', 7839, TO_DATE('1981-05-01', 'YYYY-MM-DD'), 30);
INSERT INTO emp VALUES (7782, 'CLARK', 'MANAGER', 7839, TO_DATE('1981-06-09', 'YYYY-MM-DD'), 10);
INSERT INTO emp VALUES (7566, 'JONES', 'MANAGER', 7839, TO_DATE('1981-04-02', 'YYYY-MM-DD'), 20);
INSERT INTO emp VALUES (7788, 'SCOTT', 'ANALYST', 7566, TO_DATE('1987-07-13', 'YYYY-MM-DD') - 85, 20);
INSERT INTO emp VALUES (7902, 'FORD', 'ANALYST', 7566, TO_DATE('1981-12-03', 'YYYY-MM-DD'), 20);
INSERT INTO emp VALUES (7369, 'SMITH', 'CLERK', 7902, TO_DATE('1980-12-17', 'YYYY-MM-DD'), 20);

-- Insert data into SALARY Table
INSERT INTO salary VALUES (7839, 5000, 1000);
INSERT INTO salary VALUES (7698, 2850, 500);
INSERT INTO salary VALUES (7782, 2450, 300);
INSERT INTO salary VALUES (7566, 2975, 400);
INSERT INTO salary VALUES (7788, 3000, 800);
INSERT INTO salary VALUES (7902, 3000, 800);
INSERT INTO salary VALUES (7369, 800, 100);

-- HUB_DEPT
CREATE TABLE HUB_DEPT (
    DEPT_HK NUMBER(19) PRIMARY KEY,
    DEPTNO NUMBER(2,0),
    LOAD_DATE TIMESTAMP,
    RECORD_SOURCE VARCHAR2(50)
);

-- HUB_EMP
CREATE TABLE HUB_EMP (
    EMP_HK NUMBER(19) PRIMARY KEY,
    EMPNO NUMBER(4,0),
    LOAD_DATE TIMESTAMP,
    RECORD_SOURCE VARCHAR2(50)
);

-- LINK_EMP_DEPT
CREATE TABLE LINK_EMP_DEPT (
    LINK_EMP_DEPT_HK NUMBER(19) PRIMARY KEY,
    EMP_HK NUMBER(19),
    DEPT_HK NUMBER(19),
    LOAD_DATE TIMESTAMP,
    RECORD_SOURCE VARCHAR2(50),
    FOREIGN KEY (EMP_HK) REFERENCES HUB_EMP(EMP_HK),
    FOREIGN KEY (DEPT_HK) REFERENCES HUB_DEPT(DEPT_HK)
);

-- SAT_DEPT
CREATE TABLE SAT_DEPT (
    DEPT_HK NUMBER(19),
    DNAME VARCHAR2(14),
    LOC VARCHAR2(13),
    LOAD_DATE TIMESTAMP,
    RECORD_SOURCE VARCHAR2(50),
    PRIMARY KEY (DEPT_HK, LOAD_DATE),
    FOREIGN KEY (DEPT_HK) REFERENCES HUB_DEPT(DEPT_HK)
);

-- SAT_EMP
CREATE TABLE SAT_EMP (
    EMP_HK NUMBER(19),
    ENAME VARCHAR2(10),
    JOB VARCHAR2(9),
    MGR NUMBER(4,0),
    HIRE_DATE DATE,
    LOAD_DATE TIMESTAMP,
    RECORD_SOURCE VARCHAR2(50),
    PRIMARY KEY (EMP_HK, LOAD_DATE),
    FOREIGN KEY (EMP_HK) REFERENCES HUB_EMP(EMP_HK)
);

-- SAT_SALARY
CREATE TABLE SAT_SALARY (
    EMP_HK NUMBER(19),
    SALARY NUMBER(7,2),
    BONUS NUMBER(7,2),
    LOAD_DATE TIMESTAMP,
    RECORD_SOURCE VARCHAR2(50),
    PRIMARY KEY (EMP_HK, LOAD_DATE),
    FOREIGN KEY (EMP_HK) REFERENCES HUB_EMP(EMP_HK)
);

-- Insert Data into HUB_DEPT
INSERT INTO HUB_DEPT (DEPT_HK, DEPTNO, LOAD_DATE, RECORD_SOURCE)
VALUES (1, 10, SYSTIMESTAMP, 'SOURCE_1');

INSERT INTO HUB_DEPT (DEPT_HK, DEPTNO, LOAD_DATE, RECORD_SOURCE)
VALUES (2, 20, SYSTIMESTAMP, 'SOURCE_1');

-- Insert Data into HUB_EMP
INSERT INTO HUB_EMP (EMP_HK, EMPNO, LOAD_DATE, RECORD_SOURCE)
VALUES (1, 7839, SYSTIMESTAMP, 'SOURCE_1');

INSERT INTO HUB_EMP (EMP_HK, EMPNO, LOAD_DATE, RECORD_SOURCE)
VALUES (2, 7698, SYSTIMESTAMP, 'SOURCE_1');

-- Insert Data into LINK_EMP_DEPT
INSERT INTO LINK_EMP_DEPT (LINK_EMP_DEPT_HK, EMP_HK, DEPT_HK, LOAD_DATE, RECORD_SOURCE)
VALUES (1, 1, 1, SYSTIMESTAMP, 'SOURCE_1');

-- Insert Data into SAT_DEPT
INSERT INTO SAT_DEPT (DEPT_HK, DNAME, LOC, LOAD_DATE, RECORD_SOURCE)
VALUES (1, 'ACCOUNTING', 'NEW YORK', SYSTIMESTAMP, 'SOURCE_1');

-- Insert Data into SAT_EMP
INSERT INTO SAT_EMP (EMP_HK, ENAME, JOB, MGR, HIRE_DATE, LOAD_DATE, RECORD_SOURCE)
VALUES (1, 'KING', 'PRESIDENT', NULL, TO_DATE('1981-11-17', 'YYYY-MM-DD'), SYSTIMESTAMP, 'SOURCE_1');

-- Insert Data into SAT_SALARY
INSERT INTO SAT_SALARY (EMP_HK, SALARY, BONUS, LOAD_DATE, RECORD_SOURCE)
VALUES (1, 5000, 1000, SYSTIMESTAMP, 'SOURCE_1');
