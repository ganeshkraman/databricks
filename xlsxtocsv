import pandas as pd
import csv
import os

# Loop through all files in the current directory
for filename in os.listdir('.'):
    # Check if it's an Excel file and doesn't start with '~' (to skip temp files)
    if filename.endswith('.xlsx') and not filename.startswith('~'):
        # Build the output CSV file name
        base_name = os.path.splitext(filename)[0]
        csv_file = base_name + '.csv'

        # Read the first sheet of the Excel file
        df = pd.read_excel(filename, sheet_name=0)

        # Write to CSV with all fields quoted
        df.to_csv(
            csv_file,
            index=False,
            quoting=csv.QUOTE_ALL,
            quotechar='"',
            sep=','  # You can change this to '\t' for TSV
        )

        print(f"Converted: {filename} â†’ {csv_file}")
